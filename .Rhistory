geom_line() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
scale_x_continuous(labels = fancy_scientific) +
my_gg_theme
r_tab_avg <- r_tab %>% group_by(distc, CHR_A) %>% summarise(mean=mean(R2),median=median(R2))
head(r_tab_avg)
#calc mean distance
r_tab_avg <- r_tab_avg %>% mutate(
start=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"^[0-9-e+.]+")),
end=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"[0-9-e+.]+$")),
mid=start+((end-start)/2)
)
ggplot(r_tab_avg, aes(x = mid, y = mean, color = CHR_A)) +
geom_point() +
geom_line() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
scale_x_continuous(labels = fancy_scientific) +
my_gg_theme
my_gg_theme
ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid, y = mean) ) +
my_gg_theme
ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
my_gg_theme
pdf("figures/LD_decay.test.pdf", width = 16, height = 6)
p1
p1 = ggplot(r_tab, aes(x = distance/10^3, y = R2)) +
geom_point() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p2 = ggplot(r_tab, aes(x = distance/10^3, y = R2, color = CHR_A)) +
geom_point() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_line() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
scale_x_continuous(labels = fancy_scientific) +
my_gg_theme
p4 = ggplot(r_tab_avg, aes(x = mid, y = mean, color = CHR_A)) +
geom_point() +
geom_line() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
scale_x_continuous(labels = fancy_scientific) +
my_gg_theme
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("figures/LD_decay.test.pdf", width = 16, height = 6)
p1
p2
p3
p4
p5
dev.off()
is.na(r_tab_avg)
r_tab_avg[nrow(r_tab_avg),]
#calculate means
r_tab$distc <- cut(r_tab$distance,breaks=seq(from=min(r_tab$distance)-1,to=max(r_tab$distance)+1,by=1000))
r_tab_avg <- r_tab %>% group_by(distc, CHR_A) %>% summarise(mean=mean(R2),median=median(R2))
r_tab_avg[nrow(r_tab_avg),]
max(r_tab$distance)
seq(from=min(r_tab$distance)-1,to=max(r_tab$distance)+1,by=1000) %>% head
seq(from=min(r_tab$distance)-1,to=max(r_tab$distance)+1,by=1000) %>% tail
seq(from=min(r_tab$distance)-1,to=ceiling(max(r_tab$distance)/1000)*1000 %>% tail
()
bla
seq(from=min(r_tab$distance)-1,to=ceiling(max(r_tab$distance)/1000)*1000) %>% tail
seq(from=min(r_tab$distance)-1,to=ceiling(max(r_tab$distance)/1000)*1000, by=1000) %>% tail
max(r_tab$distance)
ceiling(max(r_tab$distance)/1000)*1000
seq(from=0,to=ceiling(max(r_tab$distance)/1000)*1000,by=1000)) %>% tail
seq(from=0,to=ceiling(max(r_tab$distance)/1000)*1000,by=1000) %>% from
seq(from=0,to=ceiling(max(r_tab$distance)/1000)*1000,by=1000) %>% tail
cut(r_tab$distance,breaks=seq(from=0,to=ceiling(max(r_tab$distance)/1000)*1000,by=1000) ) %>% tail()
#calculate means
r_tab$distc <- cut(r_tab$distance,breaks=seq(from=0,to=ceiling(max(r_tab$distance)/1000)*1000,by=1000) )
r_tab_avg <- r_tab %>% group_by(distc, CHR_A) %>% summarise(mean=mean(R2),median=median(R2))
r_tab_avg[nrow(r_tab_avg),]
#calc mean distance
r_tab_avg <- r_tab_avg %>% mutate(
start=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"^[0-9-e+.]+")),
end=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"[0-9-e+.]+$")),
mid=start+((end-start)/2)
)
p1 = ggplot(r_tab, aes(x = distance/10^3, y = R2)) +
geom_point() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p1
ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD (r"^2, ")"))) +
my_gg_theme
p1 = ggplot(r_tab, aes(x = distance/10^3, y = R2)) +
geom_point() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p2 = ggplot(r_tab, aes(x = distance/10^3, y = R2, color = CHR_A)) +
geom_point() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_line() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p4 = ggplot(r_tab_avg, aes(x = mid, y = mean, color = CHR_A)) +
geom_point() +
geom_line() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("figures/LD_decay.test.pdf", width = 16, height = 6)
p1
p2
p3
p4
p5
dev.off()
p1 = ggplot(r_tab, aes(x = distance/10^3, y = R2)) +
geom_point() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p2 = ggplot(r_tab, aes(x = distance/10^3, y = R2, color = CHR_A)) +
geom_point() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_line() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p4 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean, color = CHR_A)) +
geom_point() +
geom_line() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("figures/LD_decay.test.pdf", width = 16, height = 6)
p1
p2
p3
p4
p5
dev.off()
r_tab = read.table("data/Nf_SPANDx_all_seqs/out.filtered.PASS.DP_filtered.lt25missing.biallele.mac2.rm_NA_ind.LD_decay.ld.test", header = T)
head(r_tab)
require(dplyr)
read.table("data/coverage/Nf_all_seqs/coverage_by_sample.dedup_bam.txt")
cov = read.table("data/coverage/Nf_all_seqs/coverage_by_sample.dedup_bam.txt")
colnames(cov) = c("sample", "avg_cov")
cov$sample = gsub(cov$sample, "NG", "")
?gsub
cov$sample = gsub("NG", "", cov$sample)
cov$sample
cov = read.table("data/coverage/Nf_all_seqs/coverage_by_sample.dedup_bam.txt")
colnames(cov) = c("sample", "avg_cov")
cov$sample
cov$sample = gsub("NG", "", cov$sample)
colnames(cov) = c("sample", "avg_cov")cov$sample
cov$sample
cov = read.table("data/coverage/Nf_all_seqs/coverage_by_sample.dedup_bam.txt")
colnames(cov) = c("sample", "avg_cov")
cov$sample = as.numeric(gsub("NG", "", cov$sample))
cov$sample
cov.2nd_set = cov %>% filter(sample > 100)
cov.2nd_set
cov.2nd_set$avg_cov * 42749761
cov.2nd_set$avg_cov * 42749761 %>% sum
cov.2nd_set$avg_cov * 42749761 %>% sum
sum(cov.2nd_set$avg_cov * 42749761)
sum(cov.2nd_set$avg_cov * 42749761)/10^6
sum(cov.2nd_set$avg_cov * 42749761)/10^9
counts = read.table("data/bbduk_trimmed_counts/bbduk_filtered_read_count_03312022.txt")
counts
sum(counts[1:63])
sum(counts[1:63,])
676363742/(200*10^9)
sum(counts[1:63,])/(800*10^6)
(800*10^6)*500
4e+11/(200*10^9)
sum(counts[1:63,])/(400*10^6) #800*10^6 reads per flow cell, half that per lane
877482948/3495948
(sum(counts[1:63,])/2)/(400*10^6) #800*10^6 reads per flow cell, half that per lane. The number of reads is total so divide by 2 for pairs
(sum(counts[1:63,])/2)
338181871/10^6
338.1819 * 0.001
require(dplyr)
require(ggplot2)
require(stringr)
source("R_scripts/ggplot_theme.txt")
r_tab = read.table("data/Nf_SPANDx_all_seqs/out.filtered.PASS.DP_filtered.lt25missing.biallele.mac2.rm_NA_ind.LD_decay.ld.test", header = T)
#calculate SNP dist
r_tab$distance = r_tab$BP_B - r_tab$BP_A
#calculate means
r_tab$distc <- cut(r_tab$distance,breaks=seq(from=0,to=ceiling(max(r_tab$distance)/1000)*1000,by=1000) )
r_tab_avg <- r_tab %>% group_by(distc, CHR_A) %>% summarise(mean=mean(R2),median=median(R2))
#calc mean distance
r_tab_avg <- r_tab_avg %>% mutate(
start=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"^[0-9-e+.]+")),
end=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"[0-9-e+.]+$")),
mid=start+((end-start)/2)
)
head(r_tab)
p1 = ggplot(r_tab, aes(x = distance/10^3, y = R2)) +
geom_point() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p2 = ggplot(r_tab, aes(x = distance/10^3, y = R2, color = CHR_A)) +
geom_point() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_line() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p4 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean, color = CHR_A)) +
geom_point() +
geom_line() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("figures/LD_decay.test.pdf", width = 16, height = 6)
p1
p2
p3
p4
p5
dev.off()
#all points not summarized by dist
p1 = ggplot(r_tab, aes(x = distance/10^3, y = R2)) +
geom_point() +
geom_smooth() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p1
#all points not summarized by dist
#colored by chromosome
p2 = ggplot(r_tab, aes(x = distance/10^3, y = R2, color = CHR_A)) +
geom_point() +
geom_smooth() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p2
#all points not summarized by dist
#colored by chromosome
p2 = ggplot(r_tab, aes(x = distance/10^3, y = R2, color = CHR_A)) +
geom_point(alpha = 0.5) +
geom_smooth() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p2
#all points not summarized by dist
#colored by chromosome
p2 = ggplot(r_tab, aes(x = distance/10^3, y = R2, color = CHR_A)) +
geom_point(alpha = 0.25) +
geom_smooth() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p2
#all points not summarized by dist
#colored by chromosome
p2 = ggplot(r_tab, aes(x = distance/10^3, y = R2, color = CHR_A)) +
geom_point(alpha = 0.15) +
geom_smooth() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p2
#all points not summarized by dist
p1 = ggplot(r_tab, aes(x = distance/10^3, y = R2)) +
geom_point(alpha = 0.15) +
geom_smooth() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
p1
pdf("LD_decay.all_points.pdf", width = 16, height = 6)
p1
p2
dev.off()
summarize_dist = 1000
r_tab$distc <- cut(
r_tab$distance,
breaks=seq(
from=0,
to=ceiling(max(r_tab$distance)/summarize_dist)*summarize_dist,
by=summarize_dist
)
)
r_tab_avg <- r_tab %>% group_by(distc, CHR_A) %>% summarise(mean=mean(R2),median=median(R2))
#calc mean distance
r_tab_avg <- r_tab_avg %>% mutate(
start=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"^[0-9-e+.]+")),
end=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"[0-9-e+.]+$")),
mid=start+((end-start)/2)
)
#plots of mean dists
#mean r^2 summarized of 1Kb distance windows
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_line() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#mean r^2 summarized of 1Kb distance windows
#colored by chromosome
p4 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean, color = CHR_A)) +
geom_point() +
geom_line() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#all points not summarized by dist
#line of mean r^2 summarized of 1Kb distance windows
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("figures/LD_decay.1Kb_mean.pdf", width = 16, height = 6)
p3
p4
p5
dev.off()
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_smooth() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#mean r^2 summarized of 1Kb distance windows
#colored by chromosome
p4 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean, color = CHR_A)) +
geom_point() +
geom_smooth() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#all points not summarized by dist
#line of mean r^2 summarized of 1Kb distance windows
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("figures/LD_decay.1Kb_mean.pdf", width = 16, height = 6)
p3
p4
p5
dev.off()
summarize_dist = 2500
r_tab$distc <- cut(
r_tab$distance,
breaks=seq(
from=0,
to=ceiling(max(r_tab$distance)/summarize_dist)*summarize_dist,
by=summarize_dist
)
)
r_tab_avg <- r_tab %>% group_by(distc, CHR_A) %>% summarise(mean=mean(R2),median=median(R2))
#calc mean distance
r_tab_avg <- r_tab_avg %>% mutate(
start=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"^[0-9-e+.]+")),
end=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"[0-9-e+.]+$")),
mid=start+((end-start)/2)
)
#plots of mean dists
#mean r^2 summarized of 2.5Kb distance windows
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_smooth() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#mean r^2 summarized of 2.5Kb distance windows
#colored by chromosome
p4 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean, color = CHR_A)) +
geom_point() +
geom_smooth() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#all points not summarized by dist
#line of mean r^2 summarized of 2.5Kb distance windows
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("LD_decay.2.5Kb_mean.pdf", width = 16, height = 6)
p3
p4
p5
dev.off()
summarize_dist = 5000
r_tab$distc <- cut(
r_tab$distance,
breaks=seq(
from=0,
to=ceiling(max(r_tab$distance)/summarize_dist)*summarize_dist,
by=summarize_dist
)
)
r_tab_avg <- r_tab %>% group_by(distc, CHR_A) %>% summarise(mean=mean(R2),median=median(R2))
#calc mean distance
r_tab_avg <- r_tab_avg %>% mutate(
start=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"^[0-9-e+.]+")),
end=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"[0-9-e+.]+$")),
mid=start+((end-start)/2)
)
#plots of mean dists
#mean r^2 summarized of 5Kb distance windows
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_smooth() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#mean r^2 summarized of 5Kb distance windows
#colored by chromosome
p4 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean, color = CHR_A)) +
geom_point() +
geom_smooth() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#all points not summarized by dist
#line of mean r^2 summarized of 5Kb distance windows
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("LD_decay.5Kb_mean.pdf", width = 16, height = 6)
p3
p4
p5
dev.off()
summarize_dist = 10000
r_tab$distc <- cut(
r_tab$distance,
breaks=seq(
from=0,
to=ceiling(max(r_tab$distance)/summarize_dist)*summarize_dist,
by=summarize_dist
)
)
r_tab_avg <- r_tab %>% group_by(distc, CHR_A) %>% summarise(mean=mean(R2),median=median(R2))
#calc mean distance
r_tab_avg <- r_tab_avg %>% mutate(
start=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"^[0-9-e+.]+")),
end=as.integer(str_extract(str_replace_all(distc,"[\\(\\)\\[\\]]",""),"[0-9-e+.]+$")),
mid=start+((end-start)/2)
)
#plots of mean dists
#mean r^2 summarized of 10Kb distance windows
p3 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean)) +
geom_point() +
geom_smooth() +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#mean r^2 summarized of 10Kb distance windows
#colored by chromosome
p4 = ggplot(r_tab_avg, aes(x = mid/10^3, y = mean, color = CHR_A)) +
geom_point() +
geom_smooth() +
scale_color_manual(values = c25) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
#all points not summarized by dist
#line of mean r^2 summarized of 10Kb distance windows
p5 = ggplot() +
geom_point(data = r_tab, aes(x = distance/10^3, y = R2)) +
geom_line(data = r_tab_avg, aes(x = mid/10^3, y = mean) ) +
labs(x = "Distance (Kbp)", y = expression(paste("LD r"^2))) +
my_gg_theme
pdf("LD_decay.10Kb_mean.pdf", width = 16, height = 6)
p3
p4
p5
dev.off()
q(save="no")
